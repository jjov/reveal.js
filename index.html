<!doctype html>
<html lang="En">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">

    <title>reveal.js</title>

    <link href="css/reset.css" rel="stylesheet">
    <link href="css/reveal.css" rel="stylesheet">
    <link href="css/theme/blood.css" rel="stylesheet">
    <link href="css/custom-condor-styles.css" rel="stylesheet">

    <!-- Theme used for syntax highlighting of code -->
    <link href="lib/css/monokai.css" rel="stylesheet">

    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">

        <section data-background="images/poster.png">
            <p class="demo-title">Demo</p>
        </section>
        <section>
            <h3><a>MAIN TOPICS</a></h3>
            <ol>
                <li>FIX TRANSACTIONID FOR SUBMIT ORDER API</li>
                <li>VERIZON ONLINE ACTIVATION WITH INSURANCE</li>
            </ol>
        </section>
        <section>
            <section>
                <h3><a>FIX TRANSACTIONID FOR SUBMIT ORDER API</a></h3>
            </section>
            <section>
                <h4><a> Problem Description</a></h4>
                <p> When Create Order is called and there is a problem with the sim, PAM is returning this error.</p>
                <pre>
                    <code class="hljs json"  data-trim>
                    {
                      "header": {
                        "sessionId": "f436e98e-403a-4124-900b-2401c31b147f",
                        "clientReferenceId": "6670403",
                        "correlationId": "7a92549c-4a2b-11e9-9964-060c803fb6c6",
                        "errors": [
                          {
                            "code": "PAM_NETWORKCONNECTIONID_INCOMPATIBLE",
                            "message": "Network Connection Id is incompatible",
                            "messageDetailed": "Different network connection id is required for this device and/or plan.",
                            "additionalInfo": [
                              {
                                "type": "SERVICEPROVIDER_MESSAGE",
                                "value": "00060 :: ICCID is not eligible for pairing."
                              }
                            ]
                          }
                        ]
                      }
                    }

                    </code>
                </pre>
            </section>

            <section>
                <h4><a> Problem Description</a></h4>
                <p> Error for the second call to create Order with change of sim</p>
                <pre>
                    <code class="hljs xml" data-trim>
                        <?xml version="1.0" encoding="UTF-8"?>
                        <VzwServices xmlns="http://pos.odc.vzwcorp.com">
                          <ServiceHeader>
                            <serviceName>orderProcessingComposite</serviceName>
                            <serviceAction>submitOrder</serviceAction>
                            <applicationResponseCode>00406</applicationResponseCode>
                            <applicationResponseClass>ERROR</applicationResponseClass>
                            <applicationResponseMessage>[M04:vipsvcs15:15]Transaction ID with this order key info already exists.</applicationResponseMessage>
                            <applicationResponseDetails>
                            </applicationResponseDetails>
                            <timeStamp>2019-03-19T05:50:07.079-04:00</timeStamp>
                            <storeID>9999</storeID>
                            <clientAddlInfo>6670403</clientAddlInfo>
                            <transactionId>6670403</transactionId>
                            <sessionID>f436e98e-403a-4124-900b-2401c31b147f</sessionID>
                            <serviceAreaZip>07920</serviceAreaZip>
                              ...
                          </ServiceHeader>
                          <ServiceBody>
                            <fatalErrorResponse>Error occurred during XML processing. See header info.</fatalErrorResponse>
                          </ServiceBody>
                        </VzwServices>
                    </code>
                </pre>
            </section>
            <section>
                <h4><a> submitOrder Request </a></h4>
                <pre>
                    <code class="hljs xml" data-line-numbers="5,7-15" data-trim>
                        <ns0:VzwServices xmlns:ns0="http://pos.odc.vzwcorp.com">
                          <ns0:ServiceHeader>
                            <ns0:serviceName>orderProcessingComposite</ns0:serviceName>
                            <ns0:serviceAction>submitOrder</ns0:serviceAction>
                            <ns0:transactionId>6670403</ns0:transactionId>
                            <ns0:sessionID>f436e98e-403a-4124-900b-2401c31b147f</ns0:sessionID>
                            <ns0:orderKeyInfo>
                              <ns0:clusterInfo>MIDWEST</ns0:clusterInfo>
                              <ns0:location>N784401</ns0:location>
                              <ns0:creditApplicationNum>652988084</ns0:creditApplicationNum>
                              <ns0:orderNum>2224</ns0:orderNum>
                              <ns0:billingSystem>VN</ns0:billingSystem>
                              <ns0:salesForceId>ENC</ns0:salesForceId>
                              <ns0:outletId>000122460</ns0:outletId>
                            </ns0:orderKeyInfo>
                            <ns0:originatingIPAddress>127.0.1.1</ns0:originatingIPAddress>
                            <ns0:xmlVersion>2.0</ns0:xmlVersion>
                          </ns0:ServiceHeader>
                          <ns0:ServiceBody>
                            .....
                          </ns0:ServiceBody>
                        </ns0:VzwServices>

                    </code>
                </pre>
            </section>


            <section>
                <h4><a> First Solution (rolled back)</a></h4>
                create a new transactionId for every call to submit Order
                <pre>
                    <code class="hljs json" data-trim>
                        {
                            "orderId":"6919595",
                            "isFinanced":true,
                            "errors":[
                                {
                                    "code":"PAM_RESULT_DELAYED",
                                    "message":"Service Provider unable to provide result.",
                                    "description":null,
                                    "identification":null,
                                    "additionalInfo":[
                                        {
                                            "type":"SERVICEPROVIDER_MESSAGE",
                                            "value":"[W06:vipsvcs14:14]Service setup initiated. Please refresh for order status."
                                        }
                                    ]
                                }
                            ]
                        }
                    </code>
                </pre>
            </section>

            <section>
                <h3><a> SOLUTION</a></h3>
                transactionId needs to be updated just in case the sim was changed.
                this transactionID is going to be update using timestamp as a prefix.
            </section>


            <section>
                <h1>LET'S SEE THE CODE</h1>
            </section>
        </section>

        <section>
            <h3><a>NEXT TOPIC</a></h3>
            <div>
                <div>
                    <img src="https://media.giphy.com/media/6EiJBiYKFT8OnAfkin/giphy.gif">

                </div>
            </div>
        </section>

        <section>
            <h3><a>VERIZON ONLINE ACTIVATION WITH INSURANCE</a></h3>
        </section>
        <section>
            <section>
                <h3><a>PROBLEM</a></h3>
                <div align="left">
                    <div align="left">
                        <p align="justify">The logic to support insurance service for online activations is being executed
                        on the first submit, it should be executed on the final submit after line is activated.</p>
                    </div>
                </div>
            </section>
            <section>
                <h3><a>HOW INSURANCE WERE EXECUTED FOR ONLINE ACTIVATIONS</a></h3>
                <div>
                    <div>
                        <img src="images/WRONG ONLINE UPG INSURANCE FIRST SUBMIT.png">
                    </div>
                </div>
            </section>
            <section>
                <h3><a>SOLUTION</a></h3>
                <br>
                <ul>
                    <li>Added a validation for VERIZON Carrier based on activateNow flag to invoke insurance logic
                        in orderPut Canonical workflow</li>
                    <li>If activateNow flag is true (FINALSUBMIT) then insurance workflow will be called</li>
                    <li>Added a validation on insurance workflow to support ONLINE Activations with insurance based on
                        channel flag</li>
                    <li>If channel is ONLINE then online insurance logic will be executed</li>
                </ul>
            </section>
            <section>
                <h3><a>CURRENT EXECUTION OF INSURANCE FOR ONLINE ACTIVATION</a></h3>
                <div>
                    <div>
                        <img src="images/ONLINE UPG INSURANCE FINAL SUBMIT-2.png">

                    </div>
                </div>
            </section>
            <section>
                <h4><a>ORDERPOST CANONICAL REQUEST</a></h4>
                <pre>
                    <code class="hljs json" data-trim>
                        {
                            "accountType": "INDIVIDUAL",
                            "header": {
                                "dealerCode": null,
                                "serviceProvider": "VERIZON",
                                "channel": "ONLINE",
                                "callbackURL": null,
                                "clientRepresentative": null,
                                "sessionId": "268c64f3-7e67-4360-a4bf-f35d5b7f48b7",
                                "clientReferenceId": "329367653",
                                "clientOriginationId": "0099",
                                "clientIPAddress": null
                            },
                            "store": {
                                "address": {
                                    "postOfficeBox": null,
                                    "countryCode": "US",
                                    "postalCode": "47420",
                                    "locality": "Bedford",
                                    "isPrimaryPlaceOfUsage": true,
                                    "type": "SERVICE_BILLING",
                                    "administrativeArea": "IN",
                                    "line2": null,
                                    "line1": "1000 Lincoln Ave"
                                },
                                "phoneNumber": null,
                                "name": "CRYSTAL",
                                "id": "0099",
                                "repId": null
                            },
                            "accountNumber": "0513787676",
                            "cart": {
                                "totalTaxes": null,
                                "devices": null,
                                "addOnFeatures": [

                                ],
                                "totalPrice": null,
                                "plans": [
                                    {
                                        "transactionType": "CHANGE_PLAN",
                                        "serviceContractType": "MONTH_TO_MONTH",
                                        "code": "96325",
                                        "addOnFeatures": [

                                        ],
                                        "retailIdentifiers": [

                                        ],
                                        "connections": [
                                            {
                                                "transactionType": "UPGRADE_DEVICE",
                                                "phoneNumber": "8434890244",
                                                "index": 1,
                                                "device": {
                                                    "paymentPlan": {
                                                        "firstInstallmentAmount": {
                                                            "amount": 29.31,
                                                            "code": "USD"
                                                        },
                                                        "code": "PDSSFLOC",
                                                        "lastInstallmentDueDate": null,
                                                        "installmentAmount": {
                                                            "amount": 29.16,
                                                            "code": "USD"
                                                        },
                                                        "installmentPeriod": "MONTH",
                                                        "name": null,
                                                        "downPaymentAmount": {
                                                            "amount": 0,
                                                            "code": "USD"
                                                        },
                                                        "retailIdentifiers": null,
                                                        "type": "LOAN",
                                                        "firstInstallmentDueDate": null,
                                                        "serviceDepositWaived": false,
                                                        "contractLength": 24
                                                    },
                                                    "code": "MQ732LL/A",
                                                    "technologyType": "LTE",
                                                    "model": "IPHONE 8 SILVER 64GB VZ",
                                                    "type": "SMARTPHONE",
                                                    "retailPrice": {
                                                        "amount": 699.99,
                                                        "code": "USD"
                                                    },
                                                    "addOnServices": [
                                                        {
                                                            "code": "junk",
                                                            "provider": "APPLECARE",
                                                            "retailIdentifiers": [
                                                                {
                                                                    "type": "PURCHASEORDERNUMBER",
                                                                    "value": "0255-0264118-9727"
                                                                },
                                                                {
                                                                    "type": "RANDOMTYPE",
                                                                    "value": "RANDOMVALUE"
                                                                }
                                                            ],
                                                            "recurringCharge": {
                                                                "amount": "7.99",
                                                                "code": "USD"
                                                            }
                                                        }
                                                    ],
                                                    "manufacturer": "APPLE"
                                                }
                                            }
                                        ]
                                    }
                                ]
                            },
                            "customer": {
                                "emails": [
                                    {
                                        "address": "LOIS.WAYNE@consensuscorp.com",
                                        "isPrimary": true,
                                        "type": "PERSONAL"
                                    }
                                ],
                                "addresses": [
                                    {
                                        "postOfficeBox": null,
                                        "countryCode": "US",
                                        "postalCode": "29902",
                                        "locality": "BEAUFORT",
                                        "isPrimaryPlaceOfUsage": true,
                                        "type": "SERVICE_BILLING",
                                        "administrativeArea": "SC",
                                        "line2": null,
                                        "line1": "27 JOHNNY MORRALL CIR APT H3"
                                    }
                                ],
                                "serviceProviderAuthentication": {
                                    "requestDeliveryMethod": null,
                                    "securityQuestion": null,
                                    "securityAnswer": null,
                                    "passCode": "2018",
                                    "requestDeliveryDetails": null,
                                    "accessToken": null,
                                    "oneTimePIN": null
                                },
                                "nationalId": "7676",
                                "name": {
                                    "firstName": "JUAN",
                                    "lastName": "WRIGHT"
                                },
                                "dateOfBirth": "11/28/1950",
                                "nationalIdType": "SSN"
                            }
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h4><a>SECOND ORDERPUT CANONICAL REQUEST (FINAL SUBMIT)</a></h4>
                <pre>
                    <code class="hljs json" data-trim>
                        {
                            "header": {
                                "dealerCode": null,
                                "serviceProvider": "VERIZON",
                                "channel": "ONLINE",
                                "callbackURL": null,
                                "clientRepresentative": null,
                                "sessionId": "268c64f3-7e67-4360-a4bf-f35d5b7f48b7",
                                "clientReferenceId": "329367653",
                                "clientOriginationId": "0099",
                                "clientIPAddress": null
                            },
                            "accountNumber": "0513787676",
                            "order": {
                                "plans": [
                                    {
                                        "code": "96325",
                                        "connections": [
                                            {
                                                "activateNow": true,
                                                "phoneNumber": "8434890244",
                                                "index": 1,
                                                "device": {
                                                    "serialNumber": "358330080791873",
                                                    "networkConnectionId": "89148000003631636615"
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h4><a>SECOND ORDERPUT CANONICAL RESPONSE (FINAL SUBMIT)</a></h4>
                <pre>
                    <code class="hljs json" data-trim>
                        {
                            "result": "SUCCESS",
                            "header": {
                                "sessionId": "268c64f3-7e67-4360-a4bf-f35d5b7f48b7",
                                "clientReferenceId": "329367653",
                                "correlationId": "92e37c3a-1717-11ea-989f-b270c3fce747"
                            },
                            "order": {
                                "plans": [
                                    {
                                        "connections": [
                                            {
                                                "phoneNumber": "8434890244",
                                                "activationStatus": "COMPLETE",
                                                "device": {
                                                    "serialNumber": "358330080791873",
                                                    "addOnServices": [
                                                        {
                                                            "provider": "APPLECARE",
                                                            "code": "junk",
                                                            "accountNumber": "325513273087",
                                                            "contract": {
                                                                "data": "JVBERi0xLj",
                                                                "MIMEtype": "Base64PDF"
                                                            },
                                                            "activationStatus": "COMPLETE"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    </code>
                </pre>
            </section>
            <section>
                <h3><a>Let's go to the code</a></h3>
            </section>
            <section>
                <h3><a>CHALLENGES</a></h3>
                <br>
                <div align="left">
                    <ul>
                        <li>Find out how to build the canonical response with the serial Number and network Connection ID
                            from orderPut response with the device code and the insurance data sent in the canonical
                            request of OrderPost</li>
                    </ul>
                </div>
                <br>
            </section>
        </section>
        </section>

    </div>
</div>

<script src="js/reveal.js"></script>

<script>
    // More info about config & dependencies:
    // - https://github.com/hakimel/reveal.js#configuration
    // - https://github.com/hakimel/reveal.js#dependencies
    Reveal.initialize({
        transition: 'convex', // none/fade/slide/convex/concave/zoom
        dependencies: [
            {src: 'plugin/markdown/marked.js'},
            {src: 'plugin/markdown/markdown.js'},
            {src: 'plugin/highlight/highlight.js', async: true},
            {src: 'plugin/search/search.js', async: true},
            {src: 'plugin/zoom-js/zoom.js', async: true},
            {src: 'plugin/notes/notes.js', async: true}
        ]
    });
</script>
</body>
</html>
